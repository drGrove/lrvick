<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="The personal website and blog of Lance R. Vick, Software Engineer at Tawlk LLC.">
    <meta name="viewport" content="width=device-width initial-scale=1.0 maximum-scale=1.0 user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="HandheldFriendly" content="true" />
    <meta name="MobileOptimized" content="320">
    <link rel="icon" href="http://gravatar.com/avatar/ce3b7bc97b5adbdc2cae4d231e4ebad8?s=16x16">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feeds/rss.xml">
    <link rel="stylesheet" type="text/css" media="screen" href="/css/screen.css">
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/base/jquery-ui.css" type="text/css" media="all" />
    <link rel="openid.server" href="http://www.myopenid.com/server">
    <link rel="openid.delegate" href="http://lrvick.myopenid.com">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
    <script src="/js/CuteTime/js/jquery.cuteTime.min.js"></script>
    <script type="text/javascript" src="/js/main.js"></script>
    <title>Arch linux terminals in android - Blog - Lance R. Vick</title>
  </head>
  <body>
    <div id="wrapper">
      <header>
      <h1>Lance R. Vick</h1>
      <nav>
      
      <a href="/blog/" class="current">Blog</a>
      
      <a href="/resume/" >Resume</a>
      
      <a href="/photos/" >Photos</a>
      
      <a href="/code/" >Code</a>
      
      </nav>
      </header>
      <article>
        
  <article>
  <img class="right header" src="/img/archdroid.jpg"/>
    <h2>Arch Linux Terminals in Android</h2>
    <p class="entry-timeauthor">
      Posted on:
      <time>
        <span>08</span>
        <span>May</span>
        <span>2012</span>
      </time>
    </p>
    <p>So I got a shiny new Transformer Prime and of course the first thing I wanted
to do was make sure I had a reasonable way to use it to develop on the go.</p>
<p>Option one was dual-boot... however everything I read indicated I would have
vastly reduced battery life, and I would lose the ability to do important
android tasks, like play angry birds.</p>
<p>Another solution was running a system like Ubuntu in a chroot then using a VNC
connection to loop back to it. That seemed like a terrible waste of
memory/battery/disk space when all I wanted was a sane terminal development
environment where I could use python, nodejs, vim, etc.</p>
<p>Then I realized Arch Linux supports Arm, is very lean, and it should be able to
run against an Android kernel without issue provided I got the userland all set
up properly. I set out to do just that and the result has been working out
beautifully for me. I have android running full time, get my long battery life
etc, but a full development environment is as acessible as hitting the terminal
icon when I need it. I use native Vim to take notes and program, and I have
native htop to monitor my system, etc.</p>
<p>A few people have been asking me how to do this, so I decided to hammer out a
guide which is as follows.</p>
<h3>Root your device</h3>
<p>I am going to assume that if you are even interested in something like this,
you have already rooted your device, and know that its required. If for some
reason you have not, I advise doing a google for "My device + rooting" and
then coming back here with a rooted device :)</p>
<h3>Set Up SSH server (optional)</h3>
<p>Technically optional, but highly reccomended.  Unless you have a hardware
keyboard typing out a lot of commands can be pretty painful. Setting up an SSH
server on your device will let you connect to it remotely on a computer with a
bigger screen and real keyboard.</p>
<p>I found <a href="https://play.google.com/store/apps/details?id=me.shkschneider.dropbearserver">Dropbear SSH
Server</a>
to be super easy to work with but there are plenty of other options.</p>
<h3>Ensure you have enough space on root device</h3>
<p>I would advise making sure you have at least a couple gigs of free space.
Also I would strongly advise you work on your internal device memory and not an
SD card. A full distro has lots of read/writes that will quickly destroy most
microsSDs. I speak from experience. They also tend to be much slower.</p>
<p>This guide will assume you are working in /data/local/arch. Anywhere is fine,
just adjust steps accordingly.</p>
<h3>Set up Arch Environment</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre>su
bash
<span class="nb">cd</span> /data/local/
mkdir arch
<span class="nb">cd </span>arch
wget http://archlinuxarm.org/os/ArchLinuxARM-omap-smp-latest.tar.gz
tar xzf Arch*.tar.gz
rm Arch*.tar.gz
mount -o <span class="nb">bind</span> /dev dev
mount -t proc proc proc
mount -t sysfs sysfs sys
ln -s /proc/self/fd dev/fd
<span class="nb">echo</span> <span class="s2">&quot;nameserver 8.8.8.8&quot;</span> &gt;&gt; /data/local/arch/etc/resolv.conf
</pre></div>
</td></tr></table>

<h3>Enter environment and update</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre>chroot . /bin/bash
<span class="nb">source</span> /etc/profile
<span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm-256color
<span class="nb">export </span><span class="nv">HOME</span><span class="o">=</span>/root
mount /dev/pts
pacman -Syuu
</pre></div>
</td></tr></table>

<h3>Create regular user</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre>useradd -m -G wheel,net_raw lrvick <span class="c"># your username here obviously</span>
</pre></div>
</td></tr></table>

<h3>Set up Init script</h3>
<p>You will want to set up an init script for your Android terminal emulator to
run that can drop you into your environment.</p>
<p>I use the following:</p>
<script src="https://gist.github.com/2632221.js"></script>

<p>Assuming the script is located at "/data/local/arch/init.sh" you can set up
terminal emulators with the auto-run command:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre>su -c <span class="s2">&quot;sh /data/local/arch/init.sh&quot;</span>
</pre></div>
</td></tr></table>

<p>For connectbot this can be found in:</p>
<p>Hosts &gt; long-press host &gt; Edit Host &gt; post-login automation</p>
<p>For Terminal Emulator:</p>
<p>Menu &gt; Preferences &gt; Initial Command</p>
<p>Thats it! Now every time you open a terminal it should drop you into a complete
arch linux envornment. Please post with any issues or even just to let me know
this worked out for you, so I can feel like these sorts of posts are worth
my time writing :-)</p>
  </article>
    <h2 class="comments">Comments</h2>
    <article id="disqus_thread">
    </article>
    <script type="text/javascript">
      var disqus_shortname = 'lrvick';
      var disqus_identifier = 'arch_linux_terminals_in_android';
      var disqus_title = 'Arch Linux Terminals in Android';
      var disqus_url = 'http://lrvick.net/blog/arch_linux_terminals_in_android/';
      (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>

      </article>
      <aside>
  <div class="contact vcard">
    <img src="http://gravatar.com/avatar/ce3b7bc97b5adbdc2cae4d231e4ebad8?s=200x200" alt="photo of Lance" class="photo">
    <a class="url uid fn n noprint" href="http://lrvick.net">
      <span class="given-name">Lance</span> 
      <abbr class="additional-name" title="Reagan">R.</abbr> 
      <span class="family-name">Vick</span>
    </a>
    <span class="org"><a class="url" href="http://tawlk.com">Tawlk (Loopa LLC)</a></span>
    <span class="title">Founder / Lead Engineer</span>
    <a class="email" href="mailto:lance@lrvick.net">lance@lrvick.net</a>
    <div class="adr">
      <a href="http://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q=2264+Gator+Dr.+apt+%23359+Orlando,++FL&amp;sll=28.573566,-81.312496&amp;sspn=0.006577,0.011362&amp;g=2264+Gator+Dr.+Orlando,+%23359+FL&amp;ie=UTF8&amp;hq=&amp;hnear=2264+Gator+Dr+%23359,+Orlando,+Orange,+Florida+32807&amp;ll=28.573601,-81.312481&amp;spn=0.000822,0.00142&amp;t=h&amp;z=20&amp;iwloc=A">
        <span class="street-address">2264 Gator Dr #359</span>
        <span class="locality">Orlando</span>
        <span class="region">FL</span>
        <span class="postal-code">32807</span>
        <span class="country-name">USA</span>
      </a>
    </div>
    <div class="tel">
      <span class="type">Cell</span>
      <a class="value" href="callto:14072837596">+1.407.283.7596</a>
    </div>
    <hr/>
    <a rel="me" class="url" href="http://plus.google.com/u/0/109278148620470841006">
      <img src="/img/googleplus.png" title="Google Plus" alt="Google Plus">
    </a>
    <a rel="me" class="url" href="http://www.linkedin.com/in/lrvick">
      <img src="/img/linkedin.png" title="LinkedIn" alt="LinkedIn">
    </a>
    <a rel="me" class="url" href="http://github.com/lrvick">
      <img src="/img/github.png" title="GitHub" alt="Github">
    </a>
    <a rel="me" class="url" href="http://www.facebook.com/people/Lance-Reagan-Vick/600627717">
      <img src="/img/facebook.png" title="Facebook" alt="Facebook">
    </a>
    <a rel="me" class="url" href="http://twitter.com/lrvick">
      <img src="/img/twitter.png" title="twitter" alt="Twitter">
    </a>
    <a rel="me" class="url" href="http://www.last.fm/user/lrvick">
      <img src="/img/lastfm.png" title="Last.fm" alt="Last.fm">
    </a>
    <a rel="me" class="url" href="http://www.youtube.com/lrvick">
      <img src="/img/youtube.png" title="YouTube" alt="YouTube">
    </a>
  </div>
  <h3 class="even">vCard</h3>
  <div class="qrvcard">
    <img src="/img/qrvcard.jpg" alt="vCard QR Code">
    <hr/>
    <a href="/files/lrvick.vcf">Download VCF</a>
  </div>
  <h3 class="odd">Location</h3>
  <div class="latitude">
    <div class="wrapper">
      <iframe src="http://www.google.com/latitude/apps/badge/api?user=9215320111826670805&amp;type=iframe&amp;maptype=roadmap&amp;z=12" width="178" height="219"></iframe>
    </div>
  </div>
  <h3 class="even">Github</h3>
  <div class="github">
  </div>
  <h3 class="odd">Twitter</h3>
  <div class="twitter">
  </div>
  <h3 class="even">Lastfm</h3>
  <div class="lastfm">
  </div>
  <h3 class="odd">Youtube</h3>
  <div class="youtube">
  </div>
</aside>
      <footer>
      Site generated by <a href="http://github.com/lrvick/rant">rant</a> | All content and code is <a href="http://en.wikipedia.org/wiki/Public_domain">Public Domain</a> unless otherwise specified. Take whatever you like.
      </footer>
    </div>
  </body>
</html>